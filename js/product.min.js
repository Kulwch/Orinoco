const getUrlId=window.location.search,teddyId=getUrlId.slice(1);async function getTeddy(){const id=teddyId;return fetch(`http://localhost:3000/api/teddies/${id}`).then(response=>response.json()).then(teddy=>displayTeddy(teddy)).catch(error=>{console.log("Erreur de connexion au serveur",error)})}async function displayTeddy(teddy){const element=document.querySelector(".thisTeddy");async function showColors(teddy){for(i=0;i<teddy.colors.length;i++){let option;document.querySelector("#colorSelect").innerHTML+=`<option value="${teddy.colors[i]}">${teddy.colors[i]}</option>`}}element.innerHTML+=`\n                <div class="col mx-auto>\n                    <div class="card">                      \n                        <img class="card-img-top img-fluid" src="${teddy.imageUrl}"  alt="Oh le joli nounours !" />\n                        <div class="card-body teddyInfos text-dark">\n                            <h5 class="card-title name">${teddy.name}</h5>\n                            <button id="addCart" class="btn btn-secondary addBtn" >Ajouter au panier</button>\n                            <select name="color" id="colorSelect">                                \n                                <label>couleur souhait√©e</label>\n                            </select>\n                            <p class="price">${teddy.price/100}.00 &euro;</p>\n                            <p class="description"> ${teddy.description}</p>\n                        </div>\n                    </div>\n                </div>\n            `,showColors(teddy),addToCart(teddy)}let productInCart=JSON.parse(localStorage.getItem("products"));async function addToCart(teddy){document.getElementById("addCart").onclick=e=>{e.preventDefault();const selection=document.querySelector("#colorSelect"),color=selection.value;let products={name:teddy.name,productId:teddy._id,option:color,quantity:1,price:teddy.price/100,image:teddy.imageUrl,tagKey:teddy._id+color};if(productInCart){let item=productInCart.find(item=>item.tagKey===teddy._id+color);item?(item.quantity+=1,item.price+=teddy.price/100,addStorage()):(productInCart.push(products),addStorage())}else productInCart=[],productInCart.push(products),addStorage()}}async function addStorage(){localStorage.setItem("products",JSON.stringify(productInCart))}